<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title id="site-title-meta">Mubarak Afolabi — Article Details</title>
    <link href="css/style.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/js-yaml-browser@4.1.0/dist/js-yaml.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="js/contentLoader.js"></script>

    <style>
        /* Navbar styles from articles.html */
        #site-navbar ul li img {
            width: 32px;
            height: 32px;
        }

        #site-navbar ul li a {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: white;
            cursor: pointer;
        }

        /* Specific styles for article detail page */
        #article-detail-title {
            background-color: #CDEDA2;
            color: black;
            border: 1px solid black;
            padding: 1rem 2rem;
            margin-bottom: 1rem;
            border-radius: 0.5rem;
            text-align: center;
            font-weight: 800;
            font-size: 2.25rem;
            /* text-3xl */
        }

        #article-detail-date,
        #article-detail-metadata {
            color: white;
            margin-bottom: 0.5rem;
            text-align: center;
        }

        #article-detail-date {
            font-size: 1rem;
            /* text-base */
            font-style: italic;
        }

        #article-detail-metadata {
            font-size: 1.125rem;
            /* text-lg */
            font-weight: 500;
        }

        #article-detail-content-card {
            background-color: white;
            border: 1px solid white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
            /* shadow-lg */
            color: black;
            line-height: 1.75;
            /* prose line-height */
        }

        /* Basic Markdown rendering styles for prose */
        #article-detail-full-content h1,
        #article-detail-full-content h2,
        #article-detail-full-content h3,
        #article-detail-full-content h4,
        #article-detail-full-content h5,
        #article-detail-full-content h6 {
            font-weight: bold;
            margin-top: 1.5em;
            margin-bottom: 0.75em;
            line-height: 1.2;
        }

        #article-detail-full-content h1 {
            font-size: 2.25em;
            /* 2xl */
        }

        #article-detail-full-content h2 {
            font-size: 1.875em;
            /* xl */
        }

        #article-detail-full-content h3 {
            font-size: 1.5em;
            /* lg */
        }

        #article-detail-full-content p {
            margin-bottom: 1em;
        }

        #article-detail-full-content ul,
        #article-detail-full-content ol {
            margin-bottom: 1em;
            padding-left: 1.5em;
        }

        #article-detail-full-content ul li {
            list-style-type: disc;
        }

        #article-detail-full-content ol li {
            list-style-type: decimal;
        }

        #article-detail-full-content a {
            color: #007bff;
            text-decoration: underline;
        }

        #article-detail-full-content strong {
            font-weight: bold;
        }

        #article-detail-full-content em {
            font-style: italic;
        }

        #article-detail-full-content code {
            background-color: #f3f4f6;
            padding: 0.2em 0.4em;
            border-radius: 0.3em;
            font-family: monospace;
            font-size: 0.9em;
        }

        #article-detail-full-content pre {
            background-color: #f3f4f6;
            padding: 1em;
            border-radius: 0.5em;
            overflow-x: auto;
        }
    </style>
</head>

<body class="bg-primary-background-dark text-text-light min-h-screen flex flex-col">

    <nav id="site-navbar"
        class="navbar sticky top-0 w-full border border-black backdrop-blur bg-primary-background-dark bg-opacity-50 transform transition-transform duration-500 -translate-y-full z-50">
        <ul class="flex justify-around items-center py-4">
            <li><a href="index.html" class="flex flex-col items-center"><img src="assets/Vector.svg"
                        alt="Home Icon"><span>HOME</span></a></li>
            <li><a href="about.html" class="flex flex-col items-center"><img src="assets/About Icon.svg"
                        alt="About Icon"><span>ABOUT</span></a></li>
            <li><a href="projects.html" class="flex flex-col items-center"><img src="assets/Projects Icon.svg"
                        alt="Projects Icon"><span>PROJECTS</span></a></li>
            <li><a href="articles.html" class="flex flex-col items-center"><img src="assets/Articles Icon.svg"
                        alt="Articles Icon"><span>ARTICLES</span></a></li>
            <li><a href="hireMe.html" class="flex flex-col items-center"><img src="assets/HireMe Icon.svg"
                        alt="Hire Me Icon"><span>HIRE ME</span></a></li>
            
            <li id="dark-toggle" class="flex flex-col items-center cursor-pointer"><img
                    src="assets/ToggleOff Icon.svg" alt="Toggle Dark Mode" id="dark-toggle-icon"><span>dark
                        mode</span></li>
        </ul>
    </nav>

    <main class="flex-1 py-10 px-4 container mx-auto">
        <section class="max-w-4xl mx-auto">
            <h1 id="article-detail-title">
                Loading Article...
            </h1>
            <p id="article-detail-date" class="text-base italic">
                </p>
            <p id="article-detail-metadata" class="text-lg font-medium">
                </p>

            <div id="article-detail-content-card">
                <div id="article-detail-full-content" class="prose max-w-none">
                    <p class="text-center text-text-muted">Fetching article content...</p>
                    </div>
            </div>
        </section>
    </main>

    <footer class="text-center text-text-muted bg-primary-background-dark py-4 z-40 mt-2">
        <span id="footer-text">
            </span>
    </footer>

    <script>
        // === Navbar show/hide ===
        const nav = document.getElementById('site-navbar');
        let hideTimer;

        function showNavbar() {
            nav.classList.remove('-translate-y-full');
            clearTimeout(hideTimer);
            hideTimer = setTimeout(() => nav.classList.add('-translate-y-full'), 2500);
        }
        window.addEventListener('scroll', showNavbar);
        document.addEventListener('DOMContentLoaded', showNavbar);
        nav.addEventListener('mouseenter', showNavbar);
        nav.addEventListener('mouseleave', showNavbar);
        window.addEventListener('mousemove', e => {
            if (e.clientY < 50) showNavbar();
        });

        // === Dark mode toggle ===
        const toggleLi = document.getElementById('dark-toggle');
        const toggleIcon = document.getElementById('dark-toggle-icon');
        toggleLi.addEventListener('click', () => {
            const isDark = document.documentElement.classList.toggle('dark');
            toggleIcon.src = isDark ? 'assets/ToggleOn Icon.svg' : 'assets/ToggleOff Icon.svg';
        });
        if (document.documentElement.classList.contains('dark')) toggleIcon.src = 'assets/ToggleOn Icon.svg';


        // === Article Detail Content Loading ===
        document.addEventListener('DOMContentLoaded', async () => {
            const urlParams = new URLSearchParams(window.location.search);
            const articleSlug = urlParams.get('slug'); // Get slug from URL

            const titleElement = document.getElementById('article-detail-title');
            const dateElement = document.getElementById('article-detail-date');
            const metadataElement = document.getElementById('article-detail-metadata');
            const contentElement = document.getElementById('article-detail-full-content');

            // Update Site Title in <head>
            const siteTitleMeta = document.getElementById('site-title-meta');
            // Update Header Profile Photo
            const headerProfilePhoto = document.getElementById('profile-photo-header');
            // Update Footer Text
            const footerTextSpan = document.getElementById('footer-text');


            try {
                const siteSettings = await loadSiteSettings();
                if (siteTitleMeta) {
                    siteTitleMeta.textContent = siteSettings.siteTitle ? `${siteSettings.siteTitle} — Article Details` : 'Mubarak Afolabi — Article Details';
                }
                if (headerProfilePhoto) {
                    headerProfilePhoto.src = siteSettings.profilePhotoHeader || 'assets/profile.jpg';
                }
                if (footerTextSpan) {
                    footerTextSpan.textContent = siteSettings.footerText || '© 2025 Mubarak Afolabi. All rights reserved.';
                }

                if (!articleSlug) {
                    titleElement.textContent = "Error: No Article Specified";
                    contentElement.innerHTML = `<p class="text-center text-lg text-gray-600">No article slug found in the URL. Please return to the <a href="articles.html" class="text-blue-600 hover:underline">articles list</a>.</p>`;
                    return;
                }

                const article = await loadArticleBySlug(articleSlug); // Fetch specific article by slug

                if (article) {
                    titleElement.textContent = article.title;
                    dateElement.textContent = `Published: ${new Date(article.date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}`;
                    metadataElement.textContent = `Author: ${article.author || 'Mubarak Afolabi'} | Category: ${article.categories ? article.categories.join(', ') : 'Uncategorized'}`;
                    contentElement.innerHTML = marked.parse(article.body); // Render Markdown body
                } else {
                    titleElement.textContent = "Article Not Found";
                    dateElement.textContent = "";
                    metadataElement.textContent = "";
                    contentElement.innerHTML = `
                        <p class="text-center text-lg text-gray-600">The article you are looking for does not exist or could not be loaded.</p>
                        <p class="text-center text-lg text-gray-600">Please return to the <a href="articles.html" class="text-blue-600 hover:underline">articles list</a>.</p>
                    `;
                }
            } catch (error) {
                console.error("Failed to load article or site settings:", error);
                titleElement.textContent = "Error Loading Article";
                dateElement.textContent = "";
                metadataElement.textContent = "";
                contentElement.innerHTML = `
                    <p class="text-center text-lg text-red-500">There was an error loading the article. Please try again later.</p>
                    <p class="text-center text-lg text-red-500">You can also return to the <a href="articles.html" class="text-blue-600 hover:underline">articles list</a>.</p>
                `;
            }
        });
    </script>
</body>

</html>